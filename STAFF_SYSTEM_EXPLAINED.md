# ЁЯФР Staff Management System - ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ

## ЁЯУз ржЗржорзЗржЗрж▓-ржнрж┐рждрзНрждрж┐ржХ ржкрж░рж┐ржЪржпрж╝ (Email-based Identity)

### ржорзВрж▓ ржирзАрждрж┐:
ржкрзНрж░рждрж┐ржЯрж┐ ржЗржЙржЬрж╛рж░рзЗрж░ **ржЗржЙржирж┐ржХ ржЬрж┐ржорзЗржЗрж▓ ржЖржЗржбрж┐** ржжрж┐ржпрж╝рзЗ рж╕рж┐рж╕рзНржЯрзЗржо рждрж╛ржХрзЗ ржЪрж┐ржирждрзЗ ржкрж╛рж░рзЗред

- **ржорж╛рж▓рж┐ржХ**: `keshabsarkar2018@gmail.com` тЖТ Owner Role
- **рж╕рзНржЯрж╛ржл рзз**: `staff1@gmail.com` тЖТ Cashier Role
- **рж╕рзНржЯрж╛ржл рзи**: `manager@gmail.com` тЖТ Manager Role

---

## ЁЯФД рж▓ржЧржЗржи ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ (Login Flow)

### ржзрж╛ржк рзз: Google Sign-In
```
User тЖТ Google Login тЖТ Firebase Authentication тЖТ Unique UID
```

### ржзрж╛ржк рзи: Role Detection (auth.js)
```javascript
1. ржЗржорзЗржЗрж▓ ржЪрзЗржХ ржХрж░рж╛ рж╣ржпрж╝ staff_mapping ржХрж╛рж▓рзЗржХрж╢ржирзЗ
2. ржпржжрж┐ ржкрж╛ржУржпрж╝рж╛ ржпрж╛ржпрж╝ тЖТ Staff (рждрж╛рж░ ржорж╛рж▓рж┐ржХрзЗрж░ shopId ржПржмржВ role рж╕рзЗржЯ рж╣ржпрж╝)
3. ржпржжрж┐ ржирж╛ ржкрж╛ржУржпрж╝рж╛ ржпрж╛ржпрж╝ тЖТ Owner (ржирж┐ржЬрзЗрж░ uid ржПржмржВ owner role рж╕рзЗржЯ рж╣ржпрж╝)
```

### ржзрж╛ржк рзй: localStorage рж╕рзЗржЯржЖржк
```javascript
localStorage.setItem('userRole', 'cashier/manager/owner');
localStorage.setItem('shopId', 'OWNER_UID');
localStorage.setItem('isStaff', 'true/false');
```

---

## ЁЯСе ржПржХржЗ ржбрж┐ржнрж╛ржЗрж╕рзЗ ржПржХрж╛ржзрж┐ржХ ржЗржЙржЬрж╛рж░

### рж╕рж┐ржирж╛рж░рж┐ржУ: ржжрзЛржХрж╛ржирзЗрж░ ржПржХржЯрж┐ ржХржорзНржкрж┐ржЙржЯрж╛рж░

**рж╕ржХрж╛рж▓ рззрзжржЯрж╛ - ржорж╛рж▓рж┐ржХ рж▓ржЧржЗржи:**
```
Email: keshabsarkar2018@gmail.com
Role: Owner
Access: рж╕ржм ржлрж┐ржЪрж╛рж░
```

**ржжрзБржкрзБрж░ рзиржЯрж╛ - ржорж╛рж▓рж┐ржХ рж▓ржЧржЖржЙржЯ:**
```
localStorage.clear() тЖТ рж╕ржм ржбрж╛ржЯрж╛ ржорзБржЫрзЗ ржпрж╛ржпрж╝
```

**ржжрзБржкрзБрж░ рзи:рзжрзл - ржХрзНржпрж╛рж╢рж┐ржпрж╝рж╛рж░ рж▓ржЧржЗржи:**
```
Email: cashier@gmail.com
Role: Cashier
Access: рж╢рзБржзрзБ Billing, Sales Report
```

### ржХрзЛржб (navbar.js):
```javascript
logoutBtn.addEventListener('click', () => {
    localStorage.clear();      // рж╕ржм рж▓рзЛржХрж╛рж▓ ржбрж╛ржЯрж╛ ржорзБржЫрзЗ ржлрзЗрж▓рж╛
    sessionStorage.clear();    // рж╕рзЗрж╢ржи ржбрж╛ржЯрж╛ ржорзБржЫрзЗ ржлрзЗрж▓рж╛
    auth.signOut();            // Firebase ржерзЗржХрзЗ рж▓ржЧржЖржЙржЯ
});
```

---

## ЁЯФТ рж╕рж┐ржХрж┐ржЙрж░рж┐ржЯрж┐ (Security)

### рзз. UI-Level Security (ржмрж░рзНрждржорж╛ржи)
- **navbar.js**: рж░рзЛрж▓ ржЕржирзБржпрж╛ржпрж╝рзА ржорзЗржирзБ ржжрзЗржЦрж╛ржпрж╝/рж▓рзБржХрж╛ржпрж╝
- **рж╕ржорж╕рзНржпрж╛**: рж╕рзНржЯрж╛ржл ржЪрж╛ржЗрж▓рзЗ localStorage ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рзЗ ржорзЗржирзБ ржжрзЗржЦрждрзЗ ржкрж╛рж░рзЗ
- **рж╕ржорж╛ржзрж╛ржи**: Firestore Security Rules

### рзи. Database-Level Security (ржкрзНрж░ржпрж╝рзЛржЬржи)

**Firestore Security Rules:**
```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // Helper function: Check if user is staff
    function isStaff(shopId) {
      let email = request.auth.token.email.replace('.', '_');
      return exists(/databases/$(database)/documents/staff_mapping/$(email)) &&
             get(/databases/$(database)/documents/staff_mapping/$(email)).data.shopId == shopId;
    }
    
    // Shop data access
    match /shops/{shopId}/{document=**} {
      allow read, write: if request.auth != null && 
        (request.auth.uid == shopId || isStaff(shopId));
    }
    
    // Staff mapping (рж╢рзБржзрзБ ржорж╛рж▓рж┐ржХ рж▓рж┐ржЦрждрзЗ ржкрж╛рж░ржмрзЗ)
    match /staff_mapping/{email} {
      allow read: if request.auth != null;
      allow write: if request.auth != null && 
        get(/databases/$(database)/documents/staff_mapping/$(email)).data.shopId == request.auth.uid;
    }
  }
}
```

---

## ЁЯзк ржЯрзЗрж╕рзНржЯрж┐ржВ ржЧрж╛ржЗржб

### ржЯрзЗрж╕рзНржЯ рзз: ржорж╛рж▓рж┐ржХ рж╣рж┐рж╕рзЗржмрзЗ
1. ржЖржкржирж╛рж░ ржЗржорзЗржЗрж▓ ржжрж┐ржпрж╝рзЗ рж▓ржЧржЗржи ржХрж░рзБржи
2. Staff Management ржкрзЗржЬрзЗ ржпрж╛ржи
3. ржПржХржЯрж┐ рж╕рзНржЯрж╛ржл ржпрзБржХрзНржд ржХрж░рзБржи (ржпрзЗржХрзЛржирзЛ Gmail)
4. рж▓ржЧржЖржЙржЯ ржХрж░рзБржи

### ржЯрзЗрж╕рзНржЯ рзи: рж╕рзНржЯрж╛ржл рж╣рж┐рж╕рзЗржмрзЗ (Cashier)
1. рж╕рзНржЯрж╛ржлрзЗрж░ ржЗржорзЗржЗрж▓ ржжрж┐ржпрж╝рзЗ рж▓ржЧржЗржи ржХрж░рзБржи
2. ржжрзЗржЦрзБржи рж╢рзБржзрзБ ржПржЗ ржорзЗржирзБржЧрзБрж▓рзЛ ржЖржЫрзЗ:
   - Dashboard
   - Billing
   - Sales Report
   - Advance Booking
3. Inventory, Profit/Loss ржжрзЗржЦрж╛ ржпрж╛ржмрзЗ ржирж╛

### ржЯрзЗрж╕рзНржЯ рзй: рж╕рзНржЯрж╛ржл рж╣рж┐рж╕рзЗржмрзЗ (Manager)
1. ржорзНржпрж╛ржирзЗржЬрж╛рж░рзЗрж░ ржЗржорзЗржЗрж▓ ржжрж┐ржпрж╝рзЗ рж▓ржЧржЗржи ржХрж░рзБржи
2. ржжрзЗржЦрзБржи ржПржЗ ржорзЗржирзБржЧрзБрж▓рзЛ ржЖржЫрзЗ:
   - Dashboard
   - Billing
   - Inventory
   - Add Product
   - Purchase Record
   - Sales Report
   - Expense
3. Profit/Loss, Staff Management ржжрзЗржЦрж╛ ржпрж╛ржмрзЗ ржирж╛

### ржЯрзЗрж╕рзНржЯ рзк: рж░рзЛрж▓ ржкрж░рж┐ржмрж░рзНрждржи
1. Admin Panel ржерзЗржХрзЗ рж╕рзНржЯрж╛ржлрзЗрж░ рж░рзЛрж▓ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рзБржи
2. рж╕рзНржЯрж╛ржл рж▓ржЧржЖржЙржЯ ржХрж░рзЗ ржЖржмрж╛рж░ рж▓ржЧржЗржи ржХрж░рзБржХ
3. ржирждрзБржи рж░рзЛрж▓ ржЕржирзБржпрж╛ржпрж╝рзА ржорзЗржирзБ ржжрзЗржЦрж╛ ржпрж╛ржмрзЗ

---

## ЁЯОп ржбрж╛ржЯрж╛ ржлрзНрж▓рзЛ ржбрж╛ржпрж╝рж╛ржЧрзНрж░рж╛ржо

```
тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
тФВ                    User Login                           тФВ
тФВ                 (Google Sign-In)                        тФВ
тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФмтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
                     тФВ
                     тЦ╝
         тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
         тФВ  auth.js ржЪрзЗржХ ржХрж░рзЗ:    тФВ
         тФВ  staff_mapping-ржП ржЖржЫрзЗ? тФВ
         тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФмтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
                     тФВ
        тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФ┤тФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
        тФВ                         тФВ
        тЦ╝                         тЦ╝
   тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР              тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
   тФВ  Staff  тФВ              тФВ  Owner  тФВ
   тФФтФАтФАтФАтФАтФмтФАтФАтФАтФАтФШ              тФФтФАтФАтФАтФАтФмтФАтФАтФАтФАтФШ
        тФВ                        тФВ
        тЦ╝                        тЦ╝
  localStorage:            localStorage:
  - role: cashier         - role: owner
  - shopId: OWNER_UID     - shopId: OWN_UID
  - isStaff: true         - isStaff: false
        тФВ                        тФВ
        тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФмтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
                     тФВ
                     тЦ╝
         тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
         тФВ   navbar.js рж░рзЗржирзНржбрж╛рж░   тФВ
         тФВ  (рж░рзЛрж▓ ржЕржирзБржпрж╛ржпрж╝рзА ржорзЗржирзБ)  тФВ
         тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
```

---

## ЁЯУК ржбрж╛ржЯрж╛ржмрзЗрж╕ рж╕рзНржЯрзНрж░рж╛ржХржЪрж╛рж░

### Firestore Collections:

```
firestore
тФЬтФАтФА shops
тФВ   тФФтФАтФА {OWNER_UID}
тФВ       тФЬтФАтФА shopName: "My Shop"
тФВ       тФЬтФАтФА staffs (subcollection)
тФВ       тФВ   тФФтФАтФА {STAFF_EMAIL}
тФВ       тФВ       тФЬтФАтФА name: "John Doe"
тФВ       тФВ       тФЬтФАтФА email: "john@gmail.com"
тФВ       тФВ       тФЬтФАтФА role: "cashier"
тФВ       тФВ       тФФтФАтФА addedAt: timestamp
тФВ       тФЬтФАтФА sales (subcollection)
тФВ       тФЬтФАтФА inventory (subcollection)
тФВ       тФФтФАтФА expenses (subcollection)
тФВ
тФФтФАтФА staff_mapping
    тФФтФАтФА {EMAIL_WITH_UNDERSCORE}
        тФЬтФАтФА shopId: "OWNER_UID"
        тФЬтФАтФА role: "cashier"
        тФФтФАтФА ownerEmail: "owner@gmail.com"
```

---

## тЭУ рж╕рж╛ржзрж╛рж░ржг ржкрзНрж░рж╢рзНржи (FAQ)

### Q1: рж╕рзНржЯрж╛ржл ржпржжрж┐ localStorage ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рзЗ owner ржмрж╛ржирж╛ржпрж╝?
**A:** ржорзЗржирзБ ржжрзЗржЦрждрзЗ ржкрж╛рж░ржмрзЗ ржХрж┐ржирзНрждрзБ ржбрж╛ржЯрж╛ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗ ржирж╛ (Firestore Rules ржжрж┐ржпрж╝рзЗ ржмрзНрж▓ржХ ржХрж░рж╛)ред

### Q2: ржПржХржЗ ржЗржорзЗржЗрж▓ ржжрж┐ржпрж╝рзЗ ржПржХрж╛ржзрж┐ржХ ржжрзЛржХрж╛ржирзЗ ржХрж╛ржЬ ржХрж░рж╛ ржпрж╛ржмрзЗ?
**A:** ржирж╛ред ржмрж░рзНрждржорж╛ржи рж╕рж┐рж╕рзНржЯрзЗржорзЗ ржПржХржЯрж┐ ржЗржорзЗржЗрж▓ рж╢рзБржзрзБ ржПржХржЯрж┐ ржжрзЛржХрж╛ржирзЗрж░ рж╕рзНржЯрж╛ржл рж╣рждрзЗ ржкрж╛рж░ржмрзЗред

### Q3: рж╕рзНржЯрж╛ржл рж░рж┐ржорзБржн ржХрж░рж▓рзЗ ржХрзА рж╣ржмрзЗ?
**A:** `shops/{ownerId}/staffs/{email}` ржПржмржВ `staff_mapping/{email}` ржЙржнржпрж╝ ржЬрж╛ржпрж╝ржЧрж╛ ржерзЗржХрзЗ ржбрж┐рж▓рж┐ржЯ рж╣ржмрзЗред ржкрж░ржмрж░рзНрждрзА рж▓ржЧржЗржирзЗ рж╕рзЗ owner рж╣рж┐рж╕рзЗржмрзЗ ржирж┐ржЬрзЗрж░ ржжрзЛржХрж╛ржи рждрзИрж░рж┐ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗред

### Q4: ржЕрзНржпрж╛ржбржорж┐ржи ржХрж┐ рж╕ржм ржжрзЛржХрж╛ржирзЗрж░ ржбрж╛ржЯрж╛ ржжрзЗржЦрждрзЗ ржкрж╛рж░ржмрзЗ?
**A:** рж╣рзНржпрж╛ржБред `admin.js`-ржП рж╕ржм ржжрзЛржХрж╛ржирзЗрж░ рж▓рж┐рж╕рзНржЯ рж▓рзЛржб рж╣ржпрж╝ ржПржмржВ ржЕрзНржпрж╛ржбржорж┐ржи ржпрзЗржХрзЛржирзЛ ржжрзЛржХрж╛ржи рж╕рж┐рж▓рзЗржХрзНржЯ ржХрж░рзЗ ржбрж╛ржЯрж╛ ржжрзЗржЦрждрзЗ/ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗред

---

## ЁЯЪА ржкрж░ржмрж░рзНрждрзА ржЙржирзНржирждрж┐ (Future Enhancements)

1. **Multi-Shop Support**: ржПржХржЗ ржЗржорзЗржЗрж▓ ржПржХрж╛ржзрж┐ржХ ржжрзЛржХрж╛ржирзЗ ржХрж╛ржЬ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗ
2. **Permission Granularity**: ржЖрж░ржУ рж╕рзВржХрзНрж╖рзНржо ржкрж╛рж░ржорж┐рж╢ржи (ржпрзЗржоржи: рж╢рзБржзрзБ рж░рж┐ржкрзЛрж░рзНржЯ ржжрзЗржЦрж╛, ржПржбрж┐ржЯ ржирж╛)
3. **Activity Log**: ржХрзЗ ржХржЦржи ржХрзА ржХрж░рзЗржЫрзЗ рждрж╛рж░ рж▓ржЧ
4. **Staff Invitation**: ржЗржорзЗржЗрж▓ ржжрж┐ржпрж╝рзЗ рж╕рзНржЯрж╛ржлржХрзЗ ржЗржиржнрж╛ржЗржЯ ржкрж╛ржарж╛ржирзЛ
5. **Role Expiry**: ржирж┐рж░рзНржжрж┐рж╖рзНржЯ рж╕ржоржпрж╝рзЗрж░ ржЬржирзНржп рж░рзЛрж▓ ржжрзЗржУржпрж╝рж╛

---

**ЁЯТб ржоржирзЗ рж░рж╛ржЦрзБржи:** рж╕рж┐рж╕рзНржЯрзЗржо рж╕ржмрж╕ржоржпрж╝ ржЗржорзЗржЗрж▓ ржжрж┐ржпрж╝рзЗ ржЗржЙржЬрж╛рж░ ржЪрж┐ржиржмрзЗ, localStorage рж╢рзБржзрзБ UI ржжрзНрж░рзБржд рж▓рзЛржб ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣ржпрж╝ред
