# ЁЯОп Staff Management System - Implementation Guide

## тЬЕ рж╕ржорзНржкржирзНржи рж╣ржпрж╝рзЗржЫрзЗ

1. **staff-management/index.html** - ржорж╛рж▓рж┐ржХрзЗрж░ ржкрзНржпрж╛ржирзЗрж▓ рждрзИрж░рж┐
2. **staff-management/staff.js** - рж╕рзНржЯрж╛ржл ржорзНржпрж╛ржирзЗржЬржорзЗржирзНржЯ рж▓ржЬрж┐ржХ
3. **js/auth.js** - рж╕рзНржЯрж╛ржл рж▓ржЧржЗржи рж╕рж╛ржкрзЛрж░рзНржЯ ржпрзБржХрзНржд
4. **js/navbar.js** - рж░рзЛрж▓-ржмрзЗрж╕ржб ржорзЗржирзБ ржлрж┐рж▓рзНржЯрж╛рж░рж┐ржВ
5. **js/shop-helper.js** - рж╣рзЗрж▓рзНржкрж╛рж░ ржлрж╛ржВрж╢ржи рждрзИрж░рж┐
6. **js/dashboard.js** - activeShopId ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЖржкржбрзЗржЯ

---

## ЁЯФД ржмрж╛ржХрж┐ ржлрж╛ржЗрж▓ржЧрзБрж▓рзЛ ржЖржкржбрзЗржЯ ржХрж░рж╛рж░ ржирж┐ржпрж╝ржо

### ржзрж╛ржк рзз: Import ржпрзБржХрзНржд ржХрж░рзБржи

ржкрзНрж░рждрж┐ржЯрж┐ JS ржлрж╛ржЗрж▓рзЗрж░ рж╢рзБрж░рзБрждрзЗ ржПржЗ рж▓рж╛ржЗржи ржпрзБржХрзНржд ржХрж░рзБржи:

```javascript
import { getActiveShopId } from '../js/shop-helper.js';
```

### ржзрж╛ржк рзи: Variable ржбрж┐ржХрзНрж▓рзЗржпрж╝рж╛рж░ ржХрж░рзБржи

```javascript
let currentUserId = null;
let activeShopId = null;
```

### ржзрж╛ржк рзй: onAuthStateChanged ржЖржкржбрзЗржЯ ржХрж░рзБржи

```javascript
onAuthStateChanged(auth, (user) => {
    if (user) {
        currentUserId = user.uid;
        activeShopId = getActiveShopId();
        if (activeShopId) {
            // ржЖржкржирж╛рж░ ржЗржирж┐рж╢рж┐ржпрж╝рж╛рж▓рж╛ржЗржЬрзЗрж╢ржи ржХрзЛржб
        }
    } else {
        window.location.href = '../index.html';
    }
});
```

### ржзрж╛ржк рзк: рж╕ржм ржЬрж╛ржпрж╝ржЧрж╛ржпрж╝ currentUserId ржПрж░ ржкрж░рж┐ржмрж░рзНрждрзЗ activeShopId ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи

**ржЖржЧрзЗ:**
```javascript
const salesRef = collection(db, 'shops', currentUserId, 'sales');
const inventoryRef = collection(db, 'shops', currentUserId, 'inventory');
const expenseRef = collection(db, 'shops', currentUserId, 'expenses');
```

**ржПржЦржи:**
```javascript
const salesRef = collection(db, 'shops', activeShopId, 'sales');
const inventoryRef = collection(db, 'shops', activeShopId, 'inventory');
const expenseRef = collection(db, 'shops', activeShopId, 'expenses');
```

---

## ЁЯУВ ржпрзЗ ржлрж╛ржЗрж▓ржЧрзБрж▓рзЛ ржЖржкржбрзЗржЯ ржХрж░рждрзЗ рж╣ржмрзЗ

### ржЕржЧрзНрж░рж╛ржзрж┐ржХрж╛рж░ рзз (ржЬрж░рзБрж░рж┐):
- тЬЕ `js/dashboard.js` - рж╕ржорзНржкржирзНржи
- тП│ `billing/billing.js`
- тП│ `inventory/inventory.js`
- тП│ `sales-report/report.js`

### ржЕржЧрзНрж░рж╛ржзрж┐ржХрж╛рж░ рзи (ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг):
- тП│ `add-product/add-product.js`
- тП│ `purchase-record/purchase-dashboard.js`
- тП│ `expense/expense.js`
- тП│ `sales-report/profit-loss.js`

### ржЕржЧрзНрж░рж╛ржзрж┐ржХрж╛рж░ рзй (ржЕржирзНржпрж╛ржирзНржп):
- тП│ `advance-booking/booking.js`
- тП│ `label-printer/label-printer.js`
- тП│ `shop-details/shop-details.js`

---

## ЁЯФР рж░рзЛрж▓-ржмрзЗрж╕ржб ржкрж╛рж░ржорж┐рж╢ржи

### Owner (ржорж╛рж▓рж┐ржХ):
- рж╕ржм ржлрж┐ржЪрж╛рж░ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗ
- рж╕рзНржЯрж╛ржл ржорзНржпрж╛ржирзЗржЬржорзЗржирзНржЯ
- ржкрзНрж░ржлрж┐ржЯ/рж▓рж╕ рж░рж┐ржкрзЛрж░рзНржЯ
- рж╢ржк ржбрж┐ржЯрзЗржЗрж▓рж╕

### Manager (ржорзНржпрж╛ржирзЗржЬрж╛рж░):
- ржмрж┐рж▓рж┐ржВ
- ржЗржиржнрзЗржирзНржЯрж░рж┐ ржорзНржпрж╛ржирзЗржЬржорзЗржирзНржЯ
- ржкрж╛рж░ржЪрзЗржЬ рж░рзЗржХрж░рзНржб
- рж╕рзЗрж▓рж╕ рж░рж┐ржкрзЛрж░рзНржЯ
- ржПржХрзНрж╕ржкрзЗржирзНрж╕

### Cashier (ржХрзНржпрж╛рж╢рж┐ржпрж╝рж╛рж░):
- рж╢рзБржзрзБ ржмрж┐рж▓рж┐ржВ
- рж╕рзЗрж▓рж╕ рж░рж┐ржкрзЛрж░рзНржЯ ржжрзЗржЦрж╛
- ржЕрзНржпрж╛ржбржнрж╛ржирзНрж╕ ржмрзБржХрж┐ржВ

---

## ЁЯзк ржЯрзЗрж╕рзНржЯрж┐ржВ ржЪрзЗржХрж▓рж┐рж╕рзНржЯ

### ржорж╛рж▓рж┐ржХ рж╣рж┐рж╕рзЗржмрзЗ:
- [ ] рж▓ржЧржЗржи ржХрж░рзБржи
- [ ] рж╕рзНржЯрж╛ржл ржпрзБржХрзНржд ржХрж░рзБржи (Cashier ржПржмржВ Manager)
- [ ] рж╕ржм ржорзЗржирзБ ржжрзЗржЦрж╛ ржпрж╛ржЪрзНржЫрзЗ ржХрж┐ржирж╛ ржЪрзЗржХ ржХрж░рзБржи

### рж╕рзНржЯрж╛ржл рж╣рж┐рж╕рзЗржмрзЗ (Cashier):
- [ ] рж╕рзНржЯрж╛ржлрзЗрж░ ржЗржорзЗржЗрж▓ ржжрж┐ржпрж╝рзЗ рж▓ржЧржЗржи ржХрж░рзБржи
- [ ] рж╢рзБржзрзБ Billing, Sales Report, Dashboard ржжрзЗржЦрж╛ ржпрж╛ржЪрзНржЫрзЗ ржХрж┐ржирж╛ ржЪрзЗржХ ржХрж░рзБржи
- [ ] Inventory, Profit/Loss, Staff Management рж▓рзБржХрж╛ржирзЛ ржЖржЫрзЗ ржХрж┐ржирж╛ ржЪрзЗржХ ржХрж░рзБржи

### рж╕рзНржЯрж╛ржл рж╣рж┐рж╕рзЗржмрзЗ (Manager):
- [ ] ржорзНржпрж╛ржирзЗржЬрж╛рж░рзЗрж░ ржЗржорзЗржЗрж▓ ржжрж┐ржпрж╝рзЗ рж▓ржЧржЗржи ржХрж░рзБржи
- [ ] Inventory, Purchase Record ржжрзЗржЦрж╛ ржпрж╛ржЪрзНржЫрзЗ ржХрж┐ржирж╛ ржЪрзЗржХ ржХрж░рзБржи
- [ ] Profit/Loss, Staff Management рж▓рзБржХрж╛ржирзЛ ржЖржЫрзЗ ржХрж┐ржирж╛ ржЪрзЗржХ ржХрж░рзБржи

---

## ЁЯЪи ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржирзЛржЯ

1. **localStorage ржХрзНрж▓рж┐ржпрж╝рж╛рж░**: рж▓ржЧржЖржЙржЯ ржХрж░рж╛рж░ рж╕ржоржпрж╝ `userRole`, `shopId`, `isStaff` ржХрзНрж▓рж┐ржпрж╝рж╛рж░ рж╣ржпрж╝ (navbar.js ржП ржЗрждрж┐ржоржзрзНржпрзЗ ржпрзБржХрзНржд ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ)

2. **Security**: ржПржЯрж┐ рж╢рзБржзрзБ UI-level securityред Production-ржП Firestore Security Rules ржпрзБржХрзНржд ржХрж░рждрзЗ рж╣ржмрзЗ:

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /shops/{shopId}/{document=**} {
      allow read, write: if request.auth != null && 
        (request.auth.uid == shopId || 
         exists(/databases/$(database)/documents/staff_mapping/$(request.auth.token.email.replace('.', '_'))));
    }
  }
}
```

3. **Path Issues**: ржпржжрж┐ ржХрзЛржирзЛ ржкрзЗржЬрзЗ `../js/shop-helper.js` ржХрж╛ржЬ ржирж╛ ржХрж░рзЗ, рждрж╛рж╣рж▓рзЗ рж╕ржарж┐ржХ relative path ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред

---

## ЁЯУЮ ржкрж░ржмрж░рзНрждрзА ржзрж╛ржк

ржЖржкржирж┐ ржПржЦржи ржмрж╛ржХрж┐ ржлрж╛ржЗрж▓ржЧрзБрж▓рзЛ ржПржХрзЗ ржПржХрзЗ ржЖржкржбрзЗржЯ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред ржкрзНрж░рждрж┐ржЯрж┐ ржлрж╛ржЗрж▓рзЗ ржЙржкрж░рзЗрж░ рзкржЯрж┐ ржзрж╛ржк ржлрж▓рзЛ ржХрж░рзБржиред

ржХрзЛржирзЛ рж╕ржорж╕рзНржпрж╛ рж╣рж▓рзЗ ржЬрж╛ржирж╛ржмрзЗржи! ЁЯЪА
